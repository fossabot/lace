#!/bin/sh
KOON_FILE_DIRECTORY=$(dirname "$0")
KOON_FILE_DIRECTORY=$(cd "$KOON_FILE_DIRECTORY" && pwd -P)

KOON_FILENAME=$(basename "$0")
export KOON_FILE="$KOON_FILE_DIRECTORY/$KOON_FILENAME"

KOON_SYMLINK=$(readlink $0)
if [ -n "$KOON_SYMLINK" ]
then
	KOON_SYMLINK_DIRECTORY=$(dirname "$KOON_SYMLINK")
	KOON_FILE_DIRECTORY=$(cd "$KOON_FILE_DIRECTORY" &&
	                      cd "$KOON_SYMLINK_DIRECTORY" && pwd -P)
fi

KOON_LIBRARY_DIRECTORY=$(cd "$KOON_FILE_DIRECTORY"/../lib && pwd -P)

KOON_SYSTEM=$(uname -s | tr "[:upper:]" "[:lower:]")
/usr/bin/env
if [ "$KOON_SYSTEM" = "darwin" ]
then
	exec "$KOON_LIBRARY_DIRECTORY/koon.rb" "$@"
else
	exec ruby -W0 "$KOON_LIBRARY_DIRECTORY/brew.rb" "$@"
fi
